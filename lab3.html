<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<head>

<LINK REL=StyleSheet HREF="style.css" TYPE="text/css">
</head>

<div id="container">
	<div id="header">
		<h1>
		ExploitMe Mobile Android Labs
		</h1>
	</div>
	<div id="navigation">
		<ul>
			<li><a href="index.html">Home</a></li>
			<li><a href="setup.html">Setup</a></li>
			<li><a href="lab1.html">Lab1</a></li>
			<li><a href="lab2.html">Lab2</a></li>
			<li><a href="lab3.html">Lab3</a></li>
			<li><a href="lab4.html">Lab4</a></li>
			<li><a href="lab5.html">Lab5</a></li>
			<li><a href="lab6.html">Lab6</a></li>
		</ul>
	</div>
	<div id="content">
		<h2>
		LAB 3 Insecure file storage
		</h2>
		<p>
		One of the key concepts to any mobile hacking attempts is the ability to proxy or intercept traffic to and from the server.  We will be trapping the application traffic using a proxy server in an effort to act as the man in the middle.  Often, you'll be able to see how the mobile application responds when using these techniques.
		</p><p>
		For this lab, we will be taking a look at the file permissions and preferences file local to any application.  For any android app, data for the app including application preferences are stored in 
		</p><p>
		/data/data/
		</p><p>
		A good way to connect to a device's filesystem is to use the android debugging bridge (adb).  It comes with the Android SDK and can be found in the platform-tools directory.  With the android emulator running, you use adb to browse the device ifle system by: 
		</p><p>
		adb shell
		</p><p>
		Note: If you are testing using a real device you must enable "USB Debugging" under the application development menu on your device.
		</p><p>
		<img src="img/3_adb.png" width="550" height="147" alt="" border="0">
		The # denotes that you've successfully entered the device filesystem.  Browse to the /data/data directory and list it.
		</p><p>
		<img src="img/3_datadatafolder.png" width="550" height="318" alt="" border="0">
		</p><p>
		If you look into this directory, we can find a list of Java package directories.  Lets go into the com.securitycompass.base directory, which is the directory that Android has given us to store user data.
		</p><p>
		<img src="img/3_base_dir.png" width="550" height="183" alt="" border="0">
		</p><p>
		Let's go into the shared_prefs directory.  This directory is common to all android applicaitons and holds the application preferences set by the user.
		</p><p>
		<img src="img/3_hardcoded.png" width="550" height="273" alt="" border="0">
		</p><p>
		The application preferences often hold information that will be disclosed to an attacker.  In this example we can extract the password salt and the username for the last logged in user.  You can see that in this case, it is "jdoe" and the users password of "password" which is what we logged in with in Lab 1.
		</p><p>
		Both the password hash and the password salt can be found in this preferences file, stored insecurely.
		</p><p>
		Let's go into the SDCARD directory.  SD cards are mounted at /mnt/sdcard for the emulator (this may differ on a real device).
		</p><p>
		Also, you'll notice that within the application, statemnets are created in what seems like a webview or HTML file.  We can find this HTML file on the SDCARD which can be accessed by going to
		</p><p>
		/mnt/sdcard/
		</p><p>
		the file will be named by number date and opening it will show you the insecurely stored statement file in HTML format.  anyone with access to the sdcard will be able to gain access to this file.  Also other applications could read from the file.
		<img src="img/3_sdcardperms.png" width="550" height="147" alt="" border="0">
		Take a look at the file permissoins:
		</p><p>
		----rwxr-x system   sdcard_rw      160 2011-08-03 16:48 1312361332270.html
		</p><p>
		the file is stored as world readable, allowing any other application to access the file. 
		</p><p>
		<img src="img/3_sdcard_statements.png" width="550" height="147" alt="" border="0">
		</p><p>
		We could also simply just read the HTML file right away, disclosing information about the user's bank account and statements.
		</p><p>
		
		
		<h2>Solution</h2>
		
	</body>
</html>